[![Python](https://img.shields.io/badge/-Python-464646?style=flat&logo=Python&logoColor=ffffff&color=043A6B)](https://www.python.org/)
[![Django](https://img.shields.io/badge/-Django-464646?style=flat&logo=Django&logoColor=ffffff&color=043A6B)](https://www.Django.org/)
[![Docker](https://img.shields.io/badge/-Docker-464646?style=flat&logo=Docker&logoColor=ffffff&color=043A6B)](https://www.Docker.org/)

# Foodgram

На этом сервисе пользователи смогут публиковать рецепты, подписываться на публикации других пользователей, добавлять понравившиеся рецепты в список «Избранное», а перед походом в магазин скачивать сводный список продуктов, необходимых для приготовления одного или нескольких выбранных блюд.

## Технологии
* Python
* Django
* Django REST
* Docker
* PostgreSQL
* Nginx
* Gunicorn
* GitHub actions 

### Базовые модели проекта
Более подробно с базовыми моделями можно ознакомиться в спецификации API.

### Рецепт
 Рецепт должен описываться такими полями:
 * Автор публикации (пользователь).
 * Название.
 * Картинка.
 * Текстовое описание.
 * Ингредиенты: продукты для приготовления блюда по рецепту. Множественное поле, выбор из предустановленного списка, с указанием количества и единицы измерения.
 * Тег (можно установить несколько тегов на один рецепт, выбор из предустановленных).
 * Время приготовления в минутах.
 * Все поля обязательны для заполнения.

### Тег
 Тег должен описываться такими полями:
* Название.
* Цветовой HEX-код (например, #49B64E).
* Slug.
* Все поля обязательны для заполнения и уникальны.

### Ингредиент
 Данные об ингредиентах хранятся в нескольких связанных таблицах. В результате на стороне пользователя ингредиент должен описываться такими полями:
* Название.
* Количество.
* Единицы измерения.
* Все поля обязательны для заполнения.

### Главная страница
Содержимое главной страницы — список первых шести рецептов, отсортированных по дате публикации (от новых к старым).  Остальные рецепты доступны на следующих страницах: внизу страницы есть пагинация.

### Страница рецепта
На странице — полное описание рецепта. Для авторизованных пользователей — возможность добавить рецепт в избранное и в список покупок, возможность подписаться на автора рецепта.
### Страница пользователя
На странице — имя пользователя, все рецепты, опубликованные пользователем и возможность подписаться на пользователя.
### Подписка на авторов
Подписка на публикации доступна только авторизованному пользователю. Страница подписок доступна только владельцу.
Сценарий поведения пользователя:
  1. Пользователь переходит на страницу другого пользователя или на страницу рецепта и подписывается на публикации автора кликом по кнопке «Подписаться на автора».
  2. Пользователь переходит на страницу «Мои подписки» и просматривает список рецептов, опубликованных теми авторами, на которых он подписался. Сортировка записей — по дате публикации (от новых к старым). 
  3. При необходимости пользователь может отказаться от подписки на автора: переходит на страницу автора или на страницу его рецепта и нажимает «Отписаться от автора».

### Список избранного
Работа со списком избранного доступна только авторизованному пользователю. Список избранного может просматривать только его владелец.
Сценарий поведения пользователя:
 1. Пользователь отмечает один или несколько рецептов кликом по кнопке «Добавить в избранное».
 2. Пользователь переходит на страницу «Список избранного» и просматривает персональный список избранных рецептов.
 3. При необходимости пользователь может удалить рецепт из избранного.

### Список покупок
Работа со списком покупок доступна авторизованным пользователям. Список покупок может просматривать только его владелец.
Сценарий поведения пользователя:
 1. Пользователь отмечает один или несколько рецептов кликом по кнопке «Добавить в покупки».
 2. Пользователь переходит на страницу Список покупок, там доступны все добавленные в список рецепты. Пользователь нажимает кнопку Скачать список и получает файл с суммированным перечнем и количеством необходимых ингредиентов для всех рецептов, сохранённых в «Списке покупок».
 3. При необходимости пользователь может удалить рецепт из списка покупок.
 4. Список покупок скачивается в формате .txt (или, по желанию, можно сделать выгрузку PDF).
 5. При скачивании списка покупок ингредиенты в результирующем списке не должны дублироваться; если в двух рецептах есть сахар (в одном рецепте 5 г, в другом — 10 г), то в списке должен быть один пункт: Сахар — 15 г.

### Фильтрация по тегам
При нажатии на название тега выводится список рецептов, отмеченных этим тегом. Фильтрация может проводится по нескольким тегам в комбинации «или»: если выбраны несколько тегов — в результате должны быть показаны рецепты, которые отмечены хотя бы одним из этих тегов. 
При фильтрации на странице пользователя должны фильтроваться только рецепты выбранного пользователя. Такой же принцип должен соблюдаться при фильтрации списка избранного.

### Регистрация и авторизация
В проекте должна быть доступна система регистрации и авторизации пользователей.

### Технические требования и инфраструктура
 Проект должен использовать базу данных PostgreSQL.
 В Django-проекте должен быть файл requirements.txt со всеми зависимостями.
 Проект нужно запустить в трёх контейнерах (nginx, PostgreSQL и Django) (контейнер frontend используется лишь для подготовки файлов) через docker-compose на вашем сервере в Яндекс.Облаке. Образ с проектом должен быть запушен на Docker Hub.

Проект доступен по адресу: http://158.160.43.19/recipes

Панель администратора доступна по адресу: http://158.160.43.19/admin/

Логин: admin@mail.ru

Пароль: admin

Документация API доступна по адресу: http://158.160.43.19/api/docs/

Посмотреть список доступных адресов API: http://158.160.43.19/api/

### Инструкции по развёртыванию проекта:

### Запуск проекта локально

1. Склонируйте репозиторий и прейдите в корневую директорию foodgram-project-react:

```bash
git clone SemenovY/foodgram-project-react.git
cd foodgram-project-react
```

2. В директории infra создайте файл с .env с переменными окружения:

```bash
cd infra
```

***Шаблон наполнения env файла прописан в файле .env.example.***

3. Соберите контейнер и запустите:

```bash
docker-compose up --build
```

4. Внутри контейнера backend выполните миграции, загрузите данные, соберите статику:

- выполнить миграции:

```bash
sudo docker-compose exec backend python manage.py migrate
```

- соберите статику:

```bash
sudo docker-compose exec backend python manage.py collectstatic --no-input
```

5. Создайте суперюзера:

```bash
sudo docker-compose exec backend python manage.py createsuperuser
```

6. При необходимости загрузите базу данными::

```bash
sudo docker-compose exec backend python manage.py load_ingredients
```

### Запуск проекта в автоматическом режиме

1. Со страницы репозитория https://github.com/SemenovY/foodgram-project-react.git создать fork проекта в свой GitHUB;

2. В разделе репозитория проекта Setting/Secrets:

- указать логин и пароль вашего DockerHUB с ключами

```bash
DOCKER_USERNAME, DOCKER_PASSWORD
```

- указать параметры сервера для разворачивания проекта (хост, логин, ssh-key, пароль ) с ключами:

```bash
HOST, USER, SSH_KEY, PASSPHRASE
```

- указать параметры базы данных с ключами:

```bash
DB_ENGINE, DB_NAME , POSTGRES_USER, POSTGRES_PASSWORD, DB_HOST, DB_PORT
```

- указать ID телеграм-канала и токен телеграм-бота для получения уведомлений с ключами:

```bash
TELEGRAM_TO, TELEGRAM_TOKEN
```

3. Подготовить ваш сервер:

- установить докер:

```bash
 sudo apt install docker.io
 ```

- установить docker-compose в соответствии с официальной документацией;
  https://docs.docker.com/compose/install/

- cкопировать файлы docker-compose.yaml и nginx.conf из проекта на сервер в home/<ваш_username>
  /foodgram/docker-compose.yaml и home/<ваш_username>/foodgram/nginx.conf соответственно.

4. На GitHUB выполнить любой commit, для запуска action workflow;

5. На вашем сервере, загрузить данные:

- При необходимости загрузите базу данными::

```bash
sudo docker-compose exec backend python manage.py load_ingredients
```

- создайте суперюзера:

```bash
sudo docker-compose exec backend python manage.py createsuperuser
```

В папке data подготовлен список ингредиентов с единицами измерения.
Список сохранён в форматах JSON и CSV: данные из списка будет необходимо загрузить в базу.

6. Ваш проект доступен по адресу вашего сервера:
   http://<ip_сервера>/



## Зависимости

- Python 3.10.10
- Django 3.2
- Django REST Framework 3.14.0
- Djoser 2.1.0
- Django filter 22.1
- Gunicorn 20.1.0
- Nginx 1.19.3
- Docker 20.10.22
- Postgres 13.0

_____________
***Над проектом работал:***
* Семёнов Юрий | GitHub: [SemenovY](https://github.com/SemenovY) | Python developer.

### *Free Software, Not for commercial use!*
### =^..^=______/
